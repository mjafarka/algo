

Confirmation Rate - leetcode 1934

select s.user_id, 
    round (case 
        when count(c.action) = 0 then 0
        else 
            count(case when c.action = 'confirmed' then 1 end) * 1.0 /
            ( count(case when c.action = 'timeout' then 1 end) + 
              count(case when c.action = 'confirmed' then 1 end)
             )
    end ,2 ) as confirmation_rate
 from signups s 
left join confirmations c on s.user_id = c.user_id
group by s.user_id;